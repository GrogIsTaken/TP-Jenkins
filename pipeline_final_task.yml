pipeline {
    agent any

    parameters {
        choice(
            name: 'SELECTED_EPIC', 
            choices: [
                'JANUARY - Write a Diary', 
                'FEBRUARY - Redecorate House', 
                'MARCH - Take Care of Yourself'
            ],
            description: 'Select which Epic/Month you would like to build and deploy'
        )
    }

    stages {

        stage('Checkout') {
            steps {
                echo "=== CHECKOUT STAGE ==="
                echo "Selected Epic/Month: ${params.SELECTED_EPIC}"
                // Example of checking out from Git:
                // git branch: 'main', url: 'https://github.com/YourOrg/YourProject.git'
            }
        }

        stage('Product Backlog / Ideation') {
            steps {
                echo "=== PRODUCT BACKLOG / IDEATION STAGE ==="
                sh """
                   echo 'Gathering stories for ${params.SELECTED_EPIC}...'
                   echo 'High-level prioritization...'
                   echo 'Defining acceptance criteria...'
                """
            }
        }

        stage('Refinement & Sprint Planning') {
            steps {
                echo "=== REFINEMENT & SPRINT PLANNING STAGE ==="
                sh """
                   echo 'Breaking down user stories into tasks for ${params.SELECTED_EPIC}...'
                   echo 'Estimating effort...'
                   echo 'Prioritizing the sprint backlog...'
                """
            }
        }

        stage('Implementation & Development') {
            steps {
                echo "=== IMPLEMENTATION & DEVELOPMENT STAGE ==="
                sh """
                   echo 'Implementing features for ${params.SELECTED_EPIC}...'
                   echo 'Using feature branches, pull requests, daily standups...'
                """
            }
        }

        stage('Testing & Quality Assurance') {
            steps {
                echo "=== TESTING & QA STAGE ==="
                sh """
                   echo 'Running unit and integration tests for ${params.SELECTED_EPIC}...'
                   echo 'Performing code quality checks...'
                """
                // Example placeholder for running tests:
                // sh './run-tests.sh'
            }
        }

        stage('Review & Demo') {
            steps {
                echo "=== REVIEW & DEMO STAGE ==="
                sh """
                   echo 'Demonstrating completed features for ${params.SELECTED_EPIC}...'
                   echo 'Collecting stakeholder feedback...'
                """
            }
        }

        stage('Release & Deployment') {
            steps {
                echo "=== RELEASE & DEPLOYMENT STAGE ==="
                sh """
                   echo 'Preparing release artifacts for ${params.SELECTED_EPIC}...'
                   echo 'Deploying to production (or staging) environment...'
                """
                // Example placeholder for deployment steps:
                // sh './deploy.sh --env=production'
            }
        }

        stage('Retrospective & Continuous Improvement') {
            steps {
                echo "=== RETROSPECTIVE & CONTINUOUS IMPROVEMENT STAGE ==="
                sh """
                   echo 'Conducting retrospective for ${params.SELECTED_EPIC}...'
                   echo 'Analyzing lessons learned...'
                   echo 'Planning improvements for next iteration...'
                """
            }
        }
    }

    post {
        always {
            echo "Pipeline completed for EPIC: ${params.SELECTED_EPIC}."
        }
    }
}
